!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(1),i(2);let n=Math.random;var o,r;!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right"}(o||(o={})),function(t){t[t.RP=0]="RP",t[t.LR=1]="LR",t[t.RR=2]="RR",t[t.LP=3]="LP",t[t.JP=4]="JP",t[t.UP=5]="UP",t[t.AP=6]="AP",t[t.AR=7]="AR"}(r||(r={}));var a,c=TC(document.getElementById("c"));function s(){const t=(125*n()+0)/1e3;return n()>=.5?(2-t)*Math.PI:t*Math.PI}function l(t,e){return t.position.x<e.position.x+e.width&&t.position.x+t.width>e.position.x&&t.position.y<e.position.y+e.height&&t.position.y+t.height>e.position.y}e.collide=l,(a=["bothitted.png","mountain.png","floor.png","soldier_run.png","soldier_idle.png","soldier_shooting.png","bot.png"],new Promise((t,e)=>{let i=new Array;a.forEach((e,n)=>{const o=new Image;o.src=e,o.onload=()=>{const e=document.createElement("canvas").getContext("2d");e.canvas.height=o.height,e.canvas.width=o.width,e.drawImage(o,0,0,o.width,o.height);const r={width:o.width,height:o.height,text:TCTex(c.g,e.canvas,o.width,o.height)};e.clearRect(0,0,o.width,o.height),e.save(),e.scale(-1,1),e.drawImage(o,-1*o.width,0,o.width,o.height),e.restore();const s={width:o.width,height:o.height,text:TCTex(c.g,e.canvas,o.width,o.height)};var l=2*n;i[l++]=r,i[l]=s,n==a.length-1&&setTimeout(()=>{t(i)},1e3)}})})).then(t=>{const[e,i,a,u,h,d,f,g,p,y,v,x,m,w]=t,b=function(){const t=document.createElement("canvas").getContext("2d");return t.canvas.width=4,t.canvas.height=4,t.clearRect(0,0,c.width,c.height),t.fillStyle="#ff6",t.beginPath(),t.arc(2,2,2,0,2*Math.PI),t.fill(),TCTex(c.g,t.canvas,4,4)}();let T=0,A=0,P=null;const R=10,L=30,M=6;let k=0,S=0;const[B,C]=[c.g.canvas.width,c.g.canvas.height];let E=[],V=[];function q(t,e,i){return{position:{x:t,y:e},velocity:{x:i,y:0},dir:o.Left,width:20,height:20,visible:!0,hitted:!1,life:3}}const _={position:{x:0,y:0},width:300,height:150,maxX:0,maxY:0};window.cam=_;_.position;let j=0;function O(t,e){var i=Math.random;const n=2*M,r=3*L;for(var a=0;a<10;a++){const a=i()*(n- -n)-n,s=i()*(r- -r)-r;var c=i()*Math.PI*2;E.push({position:{x:t,y:e},velocity:{x:a*Math.cos(c),y:s*Math.sin(c)},dir:o.Left,height:4,width:4,visible:!0})}}c.g.canvas.addEventListener("click",t=>{!function(t,e){var i=t.getBoundingClientRect();e.clientX,i.left,e.clientY,i.top}(c.g.canvas,t)});let I={player:{position:{x:128,y:0},velocity:{x:0,y:0},dir:o.Right,shooting:!1,width:20,height:20,visible:!0},enemies:function(t,e,i){const o=[];for(var r=0;r<i;r++)o.push(q(t,e,M*n()*2+2));return o}(34,24,5),bullets:function(t){const e=[];for(let i=0;i<t;i++)e.push({position:{x:50,y:50},velocity:{x:0,y:0},visible:!1,dir:o.Left,width:4,height:4});return e}(10)};const F=C-10,D=.7*F,Q={position:{x:40,y:D},width:100,height:20,dir:o.Left,velocity:{x:0,y:0},visible:!0},U={position:{x:230,y:D},width:260,height:20,dir:o.Left,velocity:{x:0,y:0},visible:!0},J=[Q,U],G=t=>{T=(t-k)/100,A=t,k=t,ht(I),function(t,e){j>2e-4&&function(){const t=n()%Math.PI*2,e=Math.sin(t)*j,i=Math.cos(t)*j;_.position.x=0+e,_.position.y=0+i,j*=.9}();const i=e.player;(function(t){let e=!1;for(var i=0;i<J.length;i++)e=e||lt(t,J[i]);return t.position.y+t.height==F||e})(i)&&(it=2);switch(t){case r.JP:it>0&&(it--,i.velocity.y=-L,jumpSound()),i.shooting=!1;break;case r.LP:i.dir=o.Left,i.velocity.x=-M,i.shooting=!1;break;case r.RP:i.dir=o.Right,i.velocity.x=M,i.shooting=!1;break;case r.LR:case r.RR:i.velocity.x=0;break;case r.AP:tt.reset(),i.shooting=!0,i.velocity.x=i.dir==o.Left?1.5:-1.5;for(var a=0;a<e.bullets.length;a++){const t=e.bullets[a];if(!t.visible&&0==et){const e=s();t.position.x=i.position.x+i.width+t.width,t.position.y=i.position.y+i.height/2.4,t.velocity.x=(i.dir==o.Right?35:-35)*Math.cos(e),t.velocity.y=5*Math.sin(e),t.visible=!0,et=8,fireSound(),j=2;break}}break;case r.AR:i.velocity.x=0}ut(e.player);for(a=0;a<e.enemies.length;a++){const t=e.enemies[a];0==(nt=Math.max(nt-1,0))&&(t.hitted=!1),ut(t),(t.position.x<0||t.position.x+20>B)&&(t.velocity.x=-1*t.velocity.x,t.dir=t.velocity.x>0?o.Left:o.Right),e.bullets.filter(t=>t.visible).forEach(e=>{t.visible&&l(e,t)&&(hitSound(),t.hitted=!0,nt=8,t.position.x+=e.velocity.x>0?18:-18,0==t.life?(j=4,O(t.position.x+t.width/2,t.position.y+t.height/2),t.visible=!1,t.velocity.x=0):t.life=Math.max(t.life-1,0),e.visible=!1,e.velocity.x=0)})}for(a=0;a<e.bullets.length;a++){ct(e.bullets[a])}for(a=0;a<E.length;a++){const t=E[a];ut(t),(!at(t)||lt(t,Q)||lt(t,U))&&(V.push(E[a]),E.splice(a,1))}et=Math.max(0,et-1),c=e.player,_.position.x=Math.max(c.position.x-_.width/2,0);var c}(P,I),P=null,S=requestAnimationFrame(G)};const X=t=>{switch(t.currentTarget.id){case"a":P=r.JP;break;case"b":P=r.AP;break;case"left":P=r.LP;break;case"right":P=r.RP}},Y=t=>{switch(t.currentTarget.id){case"b":P=r.AR;break;case"left":P=r.LR;break;case"right":P=r.RR}},H=document.querySelectorAll("rect"),z={passive:!0};H.forEach(t=>{t.addEventListener("touchstart",X,z),t.addEventListener("touchend",Y,z)});window.addEventListener("keydown",t=>{switch(t.keyCode){case 37:P=r.LP;break;case 39:P=r.RP;break;case 38:P=r.JP;break;case 13:P=r.UP;break;case 32:P=r.AP}},!0);function K(t,e,i,n,r){const a=r.length;let s=0,l=0;this.reset=function(){s<a-1||(s=0)},this.update=function(a){(l+=1)>i&&(l=0,s<r.length-1?s+=1:n&&(s=0));const[u,h,d,f]=r[s];let g=a.dir==o.Right?t:e;c.img(g.text,-_.position.x+(a.position.x+a.width/2),-_.position.y+a.position.y,a.width,a.height,u,h,d,f)}}window.addEventListener("keyup",t=>{switch(t.keyCode){case 37:P=r.LR;break;case 39:P=r.RR;break;case 32:P=r.AR}},!0);const N=new K(e,i,2,!0,[[0,0,1,1]]),W=new K(m,w,5,!0,[[0,0,1,.5],[0,.5,1,1]]),Z=new K(p,y,20,!0,[[0,0,1,.5],[0,.5,1,1]]),$=new K(f,g,8,!0,[[0,0,1,.2],[0,.2,1,.4],[0,.4,1,.6],[0,.6,1,.8],[0,.8,1,1]]),tt=new K(v,x,3,!1,[[0,0,1,.25],[0,.25,1,.5],[0,.5,1,.75],[0,.75,1,1]]);let et=0,it=2,nt=0;let ot=[];for(var rt=0;rt<1600;rt++)ot[rt]=1;function at(t){return t.position.y+t.height<F}function ct(t){(function(t){return t.position.x<0||t.position.x>B})(t)&&(t.visible=!1,t.velocity.x=0),t.position.x+=t.velocity.x*T,t.position.y+=t.velocity.y*T}function st(t,e){return l(t,e)&&e.position.y+e.height/2>t.position.y}function lt(t,e){return l(t,e)&&t.position.y<e.position.y}function ut(t){t.position.y=Math.min(t.position.y+t.velocity.y*T,F-t.height),t.position.x+=t.velocity.x*T,function(t){t.velocity.y=!at(t)||lt(t,Q)||lt(t,U)?t.velocity.y:t.velocity.y+R*T}(t);for(var e=0;e<J.length;e++)st(t,J[e])&&t.velocity.y<0&&(t.velocity.y=0),lt(t,J[e])&&t.velocity.y>0&&(t.velocity.y=0)}const ht=t=>{c.g.canvas.style.width="auto",c.g.canvas.style.height=Math.round(.95*window.innerHeight)+"px",c.g.viewport(0,0,c.g.canvas.width,c.g.canvas.height),function(){c.push(),c.scale(6,6);for(var t=0;t<100;t+=20)c.img(u.text,.06*-_.position.x+t,.06*-_.position.y+5,u.width,u.height,0,0,1,1);c.pop()}();const i=t.player;c.cls(),c.bkg(57/255,73/255,81/255),function(){for(var t=U.position.x;t<=U.position.x+U.width;t+=20){const e=t%7==0?d:h;c.img(e.text,-_.position.x+t,-_.position.y+(U.position.y-10),e.width,e.height,0,0,1,1)}for(t=Q.position.x;t<=Q.position.x+Q.width;t+=20){const e=t%7==0?d:h;c.img(e.text,-_.position.x+t,-_.position.y+(Q.position.y-10),e.width,e.height,0,0,1,1)}for(t=0;t<300;t+=20){const e=t%7==0?d:h;c.img(e.text,-_.position.x+t,-_.position.y+(F-10),e.width,e.height,0,0,1,1)}}(),i.shooting?tt.update(i):0==i.velocity.x?Z.update(i):$.update(i);for(var n=0;n<t.enemies.length;n++){const e=t.enemies[n];e.visible&&(e.hitted?N.update(e):W.update(e))}for(n=0;n<t.bullets.length;n++){const e=t.bullets[n];e.visible&&c.img(b,-_.position.x+e.position.x,-_.position.y+e.position.y,4,4,0,0,1,1)}for(n=0;n<E.length;n++){const t=E[n];t.visible&&c.img(e.text,-_.position.x+t.position.x,-_.position.y+t.position.y,8,8,0,0,.7,1)}for(n=0;n<V.length;n++){const t=V[n];t.visible&&c.img(e.text,-_.position.x+t.position.x,-_.position.y+t.position.y,8,8,0,0,.7,1)}c.flush()};if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){document.querySelectorAll("svg").forEach(t=>{t.style.display="block"})}requestAnimationFrame(G)})},function(t,e){function i(t,e,i){var n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),n}function n(t,e,n){var o=t.createProgram(),r=i(t,e,35633),a=i(t,n,35632);return t.attachShader(o,r),t.attachShader(o,a),t.linkProgram(o),o}function o(t,e,i,n){var o=t.createBuffer();return t.bindBuffer(e,o),t.bufferData(e,i,n),o}window.TCShd=i,window.TCPrg=n,window.TCBuf=o,window.TCTex=function(t,e,i,n){var o=t.createTexture();return t.bindTexture(3553,o),t.texParameteri(3553,10242,33071),t.texParameteri(3553,10243,33071),t.texParameteri(3553,10240,9728),t.texParameteri(3553,10241,9728),t.texImage2D(3553,0,6408,6408,5121,e),t.bindTexture(3553,null),o.width=i,o.height=n,o},window.TC=function(t){var e,i,r,a=t.getContext("webgl"),c=t.width,s=t.height,l=n(a,["precision lowp float;","attribute vec2 a, b;","attribute vec4 c;","varying vec2 d;","varying vec4 e;","uniform mat4 m;","uniform vec2 r;","void main(){","gl_Position=m*vec4(a,1.0,1.0);","d=b;","e=c;","}"].join("\n"),["precision lowp float;","varying vec2 d;","varying vec4 e;","uniform sampler2D f;","void main(){","gl_FragColor=texture2D(f,d)*e;","}"].join("\n")),u=a.bufferSubData.bind(a),h=a.drawElements.bind(a),d=a.bindTexture.bind(a),f=a.clear.bind(a),g=a.clearColor.bind(a),p=new ArrayBuffer(873760),y=new Float32Array(p),v=new Uint32Array(p),x=new Uint16Array(131064),m=o(a,34963,x.byteLength,35044),w=o(a,34962,p.byteLength,35048),b=0,T=new Float32Array([1,0,0,1,0,0]),A=new Float32Array(100),P=0,R=Math.cos,L=Math.sin,M=null,k=null;a.blendFunc(770,771),a.enable(3042),a.useProgram(l),a.bindBuffer(34963,m);for(var S=indexB=0;S<65532;S+=6,indexB+=4)x[S+0]=indexB,x[S+1]=indexB+1,x[S+2]=indexB+2,x[S+3]=indexB+0,x[S+4]=indexB+3,x[S+5]=indexB+1;return u(34963,0,x),a.bindBuffer(34962,w),e=a.getAttribLocation(l,"a"),i=a.getAttribLocation(l,"b"),r=a.getAttribLocation(l,"c"),a.enableVertexAttribArray(e),a.vertexAttribPointer(e,2,5126,0,20,0),a.enableVertexAttribArray(i),a.vertexAttribPointer(i,2,5126,0,20,8),a.enableVertexAttribArray(r),a.vertexAttribPointer(r,4,5121,1,20,16),a.uniformMatrix4fv(a.getUniformLocation(l,"m"),0,new Float32Array([2/c,0,0,0,0,-2/s,0,0,0,0,1,1,-1,1,0,0])),a.activeTexture(33984),k={g:a,c:t,col:4294967295,bkg:function(t,e,i){g(t,e,i,1)},cls:function(){f(16384)},trans:function(t,e){T[4]=T[0]*t+T[2]*e+T[4],T[5]=T[1]*t+T[3]*e+T[5]},scale:function(t,e){T[0]=T[0]*t,T[1]=T[1]*t,T[2]=T[2]*e,T[3]=T[3]*e},rot:function(t){var e=T[0],i=T[1],n=T[2],o=T[3],r=L(t),a=R(t);T[0]=e*a+n*r,T[1]=i*a+o*r,T[2]=e*-r+n*a,T[3]=i*-r+o*a},push:function(){A[P+0]=T[0],A[P+1]=T[1],A[P+2]=T[2],A[P+3]=T[3],A[P+4]=T[4],A[P+5]=T[5],P+=6},pop:function(){P-=6,T[0]=A[P+0],T[1]=A[P+1],T[2]=A[P+2],T[3]=A[P+3],T[4]=A[P+4],T[5]=A[P+5]},img:function(t,e,i,n,o,r,a,c,s){var l=e,f=i,g=e+n,x=i+o,m=e,w=i+o,A=e+n,P=i,R=T[0],L=T[1],S=T[2],B=T[3],C=T[4],E=T[5],V=0,q=k.col;(t!=M||b+1>=10922)&&(u(34962,0,p),h(4,6*b,5123,0),b=0,M!=t&&d(3553,M=t)),V=20*b,y[V++]=l*R+f*S+C,y[V++]=l*L+f*B+E,y[V++]=r,y[V++]=a,v[V++]=q,y[V++]=g*R+x*S+C,y[V++]=g*L+x*B+E,y[V++]=c,y[V++]=s,v[V++]=q,y[V++]=m*R+w*S+C,y[V++]=m*L+w*B+E,y[V++]=r,y[V++]=s,v[V++]=q,y[V++]=A*R+P*S+C,y[V++]=A*L+P*B+E,y[V++]=c,y[V++]=a,v[V++]=q,++b>=10922&&(u(34962,0,p),h(4,6*b,5123,0),b=0)},flush:function(){0!=b&&(u(34962,0,y.subarray(0,20*b)),h(4,6*b,5123,0),b=0)}}}},function(t,e){function i(t){this.n=t.createGain(),this.n.gain.value=0,this.addEventToQueue=function(){this.n.gain.linearRampToValueAtTime(0,t.currentTime),this.n.gain.linearRampToValueAtTime(1,t.currentTime+.001),this.n.gain.linearRampToValueAtTime(.3,t.currentTime+.101),this.n.gain.linearRampToValueAtTime(0,t.currentTime+.5)}}var n=new(window.AudioContext||window.webkitAudioContext),o=new function(t){for(var e=t.sampleRate,i=t.createBuffer(1,e,t.sampleRate),n=i.getChannelData(0),o=0;o<e;o++)n[o]=2*Math.random()-1;this.s=t.createBufferSource(),this.s.buffer=i,this.s.loop=!0}(n),r=new i(n),a=new i(n),c=new i(n),s=new i(n),l=n.createBiquadFilter(),u=n.createGain(),h=0,d=!1;o.s.connect(r.n),o.s.connect(a.n),o.s.connect(c.n),o.s.connect(s.n),l.type="lowpass",l.Q.value=1,l.frequency.value=800,r.n.connect(l),a.n.connect(l),c.n.connect(l),s.n.connect(l),u.gain.value=5,l.connect(u),u.connect(n.destination);var f=n.createOscillator();f.type="square";var g=n.createGain();f.connect(g),g.connect(n.destination),g.gain.setValueAtTime(0,n.currentTime);var p=!1;window.fireSound=function(){d||(d=!0,o.s.start(0)),++h>4&&(h=1),1==h&&r.addEventToQueue(),2==h&&a.addEventToQueue(),3==h&&c.addEventToQueue(),4==h&&s.addEventToQueue()},window.jumpSound=function(){const t=(2*Math.random()+1)/2;p||(f.start(0),p=!0),f.frequency.setValueAtTime(200*t,n.currentTime),g.gain.setValueAtTime(.1,n.currentTime),g.gain.exponentialRampToValueAtTime(.6,n.currentTime+.1),f.frequency.exponentialRampToValueAtTime(280*t,n.currentTime+.4),g.gain.exponentialRampToValueAtTime(.001,n.currentTime+.4),g.gain.setValueAtTime(0,n.currentTime+.4)},window.hitSound=function(){var t=n.createOscillator();t.type="square";var e=n.createGain();t.connect(e),e.connect(n.destination),e.gain.setValueAtTime(0,n.currentTime),t.type="square",t.frequency=880.6,t.start(0),e.gain.setValueAtTime(1,n.currentTime),t.frequency.exponentialRampToValueAtTime(.01,n.currentTime+.5),e.gain.exponentialRampToValueAtTime(.01,n.currentTime+.5),e.gain.setValueAtTime(0,n.currentTime+.5)}}]);